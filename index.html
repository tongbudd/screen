<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Screen by tongbudd</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Screen</h1>
      <h2 class="project-tagline">整理屏幕截屏并保存相册</h2>
      <a href="https://github.com/tongbudd/screen" class="btn">View on GitHub</a>
      <a href="https://github.com/tongbudd/screen/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/tongbudd/screen/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>//全屏截图，包括window</p>

<ul>
<li>
<p>(IBAction)fullScreenshots:(id)sender {</p>

<p>UIWindow *screenWindow = [[UIApplication sharedApplication] keyWindow];</p>

<p>UIGraphicsBeginImageContext(screenWindow.frame.size);//全屏截图，包括window</p>

<p>[screenWindow.layer renderInContext:UIGraphicsGetCurrentContext()];</p>

<p>UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();</p>

<p>UIGraphicsEndImageContext();</p>

<p>UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil);</p>

<p>[self AlertView];//保存后弹框提示
}
//currentView 当前的view</p>
</li>
<li>
<p>(IBAction)currentView:(id)sender {
UIGraphicsBeginImageContext(self.view.bounds.size); //currentView 当前的view</p>

<p>[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];</p>

<p>UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();</p>

<p>UIGraphicsEndImageContext();</p>

<p>UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil);  //保存到相册中</p>

<p>[self AlertView]; //保存后弹框提示
}
//currentView 当前的view指定范围  截取自定义的大小</p>
</li>
<li>
<p>(IBAction)currentView_set:(id)sender {</p>

<p>UIGraphicsBeginImageContext(CGSizeMake(320, 300)); //currentView 当前的view</p>

<p>[self.view.layer renderInContext:UIGraphicsGetCurrentContext()];</p>

<p>UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();</p>

<p>UIGraphicsEndImageContext();</p>

<p>UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil);  //保存到相册中</p>

<p>[self AlertView];//保存后弹框提示
}</p>
</li>
</ul>

<p>//截屏--包括window,处理后清晰</p>

<ul>
<li>
<p>(IBAction)ceshi:(id)sender {</p>

<p>UIWindow *screenWindow = [[UIApplication sharedApplication] keyWindow];
UIGraphicsBeginImageContextWithOptions(screenWindow.frame.size, NO, 0.0); // no ritina</p>

<p>CGContextRef context = UIGraphicsGetCurrentContext();</p>

<p>CGContextSaveGState(context);
for (UIWindow *window in [[UIApplication sharedApplication] windows]) {</p>

<pre><code>if(window == screenWindow)
{
    break;
}else{
    [window.layer renderInContext:context];
}
</code></pre>

<p>}</p>

<p>if ([screenWindow respondsToSelector:<a href="https://github.com/selector" class="user-mention">@selector</a>(drawViewHierarchyInRect:afterScreenUpdates:)]) {
    [screenWindow drawViewHierarchyInRect:screenWindow.bounds afterScreenUpdates:YES];
} else {
    [screenWindow.layer renderInContext:context];
}
CGContextRestoreGState(context);
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
screenWindow.layer.contents = nil;
UIGraphicsEndImageContext();</p>

<p>float iOSVersion = [UIDevice currentDevice].systemVersion.floatValue;
if(iOSVersion &lt; 8.0)
{
    image = [self rotateUIInterfaceOrientationImage:image];
}</p>

<p>UIGraphicsEndImageContext();</p>

<p>UIImageWriteToSavedPhotosAlbum(image, nil, nil, nil);  //保存到相册中</p>

<p>[self AlertView];//保存后弹框提示
}</p>
</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/tongbudd/screen">Screen</a> is maintained by <a href="https://github.com/tongbudd">tongbudd</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
